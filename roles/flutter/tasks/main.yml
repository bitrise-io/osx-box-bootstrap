---
- name: Download flutter from stable channel
  unarchive:
    src: https://storage.googleapis.com/flutter_infra/releases/stable/macos/flutter_macos_v{{ flutter_version }}-stable.zip
    dest: "{{ flutter_home }}"
    mode: 0770
    remote_src: yes
    owner: vagrant
    group: admin
  become: yes

- name: Creates profile.d directory
  file:
    path: $HOME/profile.d
    state: directory

- name: Basic Template Example
  template:
    src: patch.j2
    dest: $HOME/profile.d/patch.sh

# - name: Ensure patch file exists
#   copy:
#     content: ""
#     dest: $HOME/profile.d/patch2.sh
#     force: no
#
# - name: Patch .bashrc
#   blockinfile:
#     path: $HOME/profile.d/patch2.sh
#     block: "{{ lookup('template', 'patch.j2') }}"
#     marker: "# {mark} ANSIBLE MANAGED BLOCK - Android Additions"

- name: Run flutter precache
  shell: bash -l -c "{{ flutter_home }}/flutter/bin/flutter precache"

- name: Run flutter doctor
  shell: bash -l -c "{{ flutter_home }}/flutter/bin/flutter doctor"
...
